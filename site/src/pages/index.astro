---
import Base from '../layouts/Base.astro';
import { readFileSync } from 'node:fs';
import { resolve } from 'node:path';

const versionPath = resolve(process.cwd(), '..', 'VERSION');
const version = readFileSync(versionPath, 'utf-8').trim();

const rawBase = import.meta.env.BASE_URL;
const base = rawBase.endsWith('/') ? rawBase : rawBase + '/';
---

<Base title="AAVP — Anonymous Age Verification Protocol" currentPage="home">

  <section class="hero">
    <h1 class="hero-title">AAVP</h1>
    <p class="hero-subtitle">
      Que las plataformas sepan si un usuario es menor de edad, sin necesidad de saber quién es.
    </p>
    <span class="hero-version">v{version} — Borrador</span>
    <div class="hero-badges">
      <a href={`${base}verificacion/`}>
        <img src="https://github.com/jorgej-ramos/AAVP/actions/workflows/spec-consistency.yml/badge.svg" alt="Spec Consistency" />
      </a>
    </div>
    <div class="hero-cta">
      <a href={`${base}white-paper/`} class="btn btn-primary">Leer el White Paper</a>
      <a href={`${base}protocolo/`} class="btn btn-secondary">Especificación Técnica</a>
    </div>
  </section>

  <section class="section">
    <h2 class="section-title">El problema</h2>
    <p class="section-subtitle">
      Las plataformas necesitan saber si un usuario es menor de edad. Hoy, la única forma de averiguarlo es pedir datos personales. AAVP demuestra que no tiene por qué ser así.
    </p>
    <div class="problem-grid">
      <div class="problem-card">
        <p class="problem-card-title">Documento de identidad</p>
        <p class="problem-card-text">Crea almacenes de documentos que los hackers intentan robar. Un DNI filtrado no puede revocarse como una contraseña.</p>
      </div>
      <div class="problem-card">
        <p class="problem-card-title">Reconocimiento facial</p>
        <p class="problem-card-text">Exige entregar una foto de tu cara — el dato más protegido por la ley — y además funciona peor con determinados tonos de piel.</p>
      </div>
      <div class="problem-card">
        <p class="problem-card-title">Tarjeta de crédito</p>
        <p class="problem-card-text">Asocia la identidad financiera del usuario con su actividad en plataformas. Los menores ya pueden tener tarjetas prepago.</p>
      </div>
      <div class="problem-card">
        <p class="problem-card-title">Autodeclaración</p>
        <p class="problem-card-text">No funciona. Ningún menor que quiera acceder a un contenido se detiene ante una casilla de verificación.</p>
      </div>
    </div>
  </section>

  <section class="section" style="background: var(--color-surface); border-top: 1px solid var(--color-border); border-bottom: 1px solid var(--color-border);">
    <h2 class="section-title">Cómo funciona</h2>
    <p class="section-subtitle">
      AAVP transmite solo una cosa: la franja de edad. Sin nombre, sin foto, sin ningún dato que identifique al usuario.
    </p>
    <div class="steps">
      <div class="step">
        <p class="step-title">Crea la pulsera</p>
        <p class="step-text">El dispositivo crea una credencial anónima — como una pulsera de cine — que dice "este usuario tiene entre 13 y 15 años" y nada más.</p>
      </div>
      <div class="step">
        <p class="step-title">La enseña</p>
        <p class="step-text">Cuando tu hijo entra en una plataforma compatible (TikTok, YouTube...), el dispositivo presenta la pulsera automáticamente.</p>
      </div>
      <div class="step">
        <p class="step-title">Se comprueba</p>
        <p class="step-text">La plataforma verifica que la pulsera es legítima y adapta el contenido según la franja de edad.</p>
      </div>
      <div class="step">
        <p class="step-title">Se renueva</p>
        <p class="step-text">La pulsera se destruye y se cambia por una nueva cada pocas horas. Nadie puede usarla para rastrear al usuario.</p>
      </div>
    </div>
  </section>

  <section class="section" style="text-align: center;">
    <h2 class="section-title">En una frase</h2>
    <p class="section-subtitle" style="max-width: 44rem; margin-left: auto; margin-right: auto; font-size: 1.15rem; line-height: 1.7;">
      AAVP es como ponerle a tu hijo una pulsera de color cada vez que entra en una plataforma digital: la plataforma ve la franja de edad, pero no sabe quién lleva la pulsera. Y la pulsera se cambia cada pocas horas para que nadie pueda seguirle la pista.
    </p>
  </section>

  <section class="section" style="background: var(--color-surface); border-top: 1px solid var(--color-border); border-bottom: 1px solid var(--color-border);">
    <h2 class="section-title">Principios de diseño</h2>
    <p class="section-subtitle">
      Cuatro reglas que no se negocian. Si un software no cumple alguna, no es AAVP.
    </p>
    <div class="principles">
      <div class="principle">
        <div class="principle-icon">
          <svg width="20" height="20" viewBox="0 0 20 20" fill="none" stroke="currentColor" stroke-width="1.5">
            <rect x="3" y="9" width="14" height="9" rx="2" />
            <path d="M6 9V6a4 4 0 0 1 8 0v3" />
          </svg>
        </div>
        <p class="principle-title">Privacidad por Diseño</p>
        <p class="principle-text">Los datos personales no salen del dispositivo. No es una promesa: es una garantía matemática.</p>
      </div>
      <div class="principle">
        <div class="principle-icon">
          <svg width="20" height="20" viewBox="0 0 20 20" fill="none" stroke="currentColor" stroke-width="1.5">
            <circle cx="10" cy="5" r="2.5" />
            <circle cx="4" cy="15" r="2.5" />
            <circle cx="16" cy="15" r="2.5" />
            <line x1="10" y1="7.5" x2="4" y2="12.5" />
            <line x1="10" y1="7.5" x2="16" y2="12.5" />
          </svg>
        </div>
        <p class="principle-title">Descentralización</p>
        <p class="principle-text">No hay jefe ni autoridad central. Como los idiomas: nadie es dueño del español.</p>
      </div>
      <div class="principle">
        <div class="principle-icon">
          <svg width="20" height="20" viewBox="0 0 20 20" fill="none" stroke="currentColor" stroke-width="1.5">
            <path d="M4 7h12M4 13h12M7 4v12M13 4v12" />
          </svg>
        </div>
        <p class="principle-title">Estándar Abierto</p>
        <p class="principle-text">Cualquiera puede implementarlo, sin licencias ni tasas. Como el correo electrónico.</p>
      </div>
      <div class="principle">
        <div class="principle-icon">
          <svg width="20" height="20" viewBox="0 0 20 20" fill="none" stroke="currentColor" stroke-width="1.5">
            <rect x="3" y="3" width="14" height="14" rx="2" />
            <line x1="8" y1="7" x2="12" y2="7" />
          </svg>
        </div>
        <p class="principle-title">Minimalismo de Datos</p>
        <p class="principle-text">Solo la franja de edad. Ningún otro dato. Cada dato extra sería una pista para rastrear.</p>
      </div>
    </div>
  </section>

  <section class="section" style="text-align: center; padding-bottom: 5rem;">
    <h2 class="section-title">Consulta la documentación completa</h2>
    <p class="section-subtitle">
      El white paper explica qué es AAVP y por qué es necesario. La especificación técnica detalla cómo implementarlo. El análisis de seguridad evalúa sus posibles vulnerabilidades.
    </p>
    <div class="hero-cta">
      <a href={`${base}white-paper/`} class="btn btn-primary">White Paper</a>
      <a href={`${base}protocolo/`} class="btn btn-secondary">Especificación Técnica</a>
      <a href={`${base}seguridad/`} class="btn btn-secondary">Análisis de Seguridad</a>
      <a href={`${base}verificacion/`} class="btn btn-secondary">Verificación</a>
      <a href="https://github.com/jorgej-ramos/AAVP" class="btn btn-secondary" target="_blank" rel="noopener">GitHub</a>
    </div>
  </section>

</Base>

<style>
  .hero-badges {
    display: flex;
    justify-content: center;
    gap: 0.5rem;
    flex-wrap: wrap;
    margin-bottom: 1.5rem;
  }

  .hero-badges img {
    height: 22px;
    display: block;
  }
</style>
